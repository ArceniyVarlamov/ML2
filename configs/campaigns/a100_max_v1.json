{
  "name": "a100_max_v1",
  "description": "Max-value A100 queue: H9 full XGB, H6 strong, DART diversity source. Resumable.",
  "workdir": "../..",
  "log_dir": "artifacts_campaigns/a100_max_v1",
  "env": {
    "OMP_NUM_THREADS": "8",
    "MKL_NUM_THREADS": "8",
    "NUMEXPR_NUM_THREADS": "8"
  },
  "tasks": [
    {
      "id": "preflight",
      "cmd": "bash scripts/a100_preflight.sh"
    },
    {
      "id": "h9_write_meta",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h9_full_xgb_v1.json write-meta",
      "done_if_all_exist": [
        "artifacts_a100_h9_full_xgb_v1/meta/columns.json",
        "artifacts_a100_h9_full_xgb_v1/meta/fold_ids.npy",
        "artifacts_a100_h9_full_xgb_v1/meta/config_snapshot.json"
      ]
    },
    {
      "id": "h9_run_bases_xgb",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h9_full_xgb_v1.json run-bases --models xgboost",
      "done_if_all_exist": [
        "artifacts_a100_h9_full_xgb_v1/base/xgboost_oof.parquet",
        "artifacts_a100_h9_full_xgb_v1/base/xgboost_test.parquet",
        "artifacts_a100_h9_full_xgb_v1/scores/xgboost_scores.json"
      ]
    },
    {
      "id": "h9_blend",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h9_full_xgb_v1.json blend --models xgboost",
      "done_if_all_exist": [
        "artifacts_a100_h9_full_xgb_v1/ensemble/blend_oof.parquet",
        "artifacts_a100_h9_full_xgb_v1/ensemble/blend_test.parquet",
        "artifacts_a100_h9_full_xgb_v1/scores/blend_scores.json"
      ]
    },
    {
      "id": "h6s_write_meta",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h6_targetaware_strong_gpu_v1.json write-meta",
      "done_if_all_exist": [
        "artifacts_a100_h6_targetaware_strong_gpu_v1/meta/columns.json",
        "artifacts_a100_h6_targetaware_strong_gpu_v1/meta/fold_ids.npy",
        "artifacts_a100_h6_targetaware_strong_gpu_v1/meta/config_snapshot.json"
      ]
    },
    {
      "id": "h6s_run_bases",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h6_targetaware_strong_gpu_v1.json run-bases --models catboost,lightgbm,xgboost",
      "done_if_all_exist": [
        "artifacts_a100_h6_targetaware_strong_gpu_v1/base/catboost_oof.parquet",
        "artifacts_a100_h6_targetaware_strong_gpu_v1/base/lightgbm_oof.parquet",
        "artifacts_a100_h6_targetaware_strong_gpu_v1/base/xgboost_oof.parquet"
      ]
    },
    {
      "id": "h6s_blend",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h6_targetaware_strong_gpu_v1.json blend --models catboost,lightgbm,xgboost",
      "done_if_all_exist": [
        "artifacts_a100_h6_targetaware_strong_gpu_v1/ensemble/blend_oof.parquet",
        "artifacts_a100_h6_targetaware_strong_gpu_v1/ensemble/blend_test.parquet",
        "artifacts_a100_h6_targetaware_strong_gpu_v1/scores/blend_scores.json"
      ]
    },
    {
      "id": "dart_run_bases",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h4_dart_xgb_lgb_v1.json run-bases --models lightgbm,xgboost",
      "done_if_all_exist": [
        "artifacts_a100_h4_dart_xgb_lgb_v1/base/lightgbm_oof.parquet",
        "artifacts_a100_h4_dart_xgb_lgb_v1/base/xgboost_oof.parquet"
      ]
    },
    {
      "id": "dart_blend",
      "cmd": "./.venv/bin/python top1_pipeline.py --config configs/top1_a100_h4_dart_xgb_lgb_v1.json blend --models lightgbm,xgboost",
      "done_if_all_exist": [
        "artifacts_a100_h4_dart_xgb_lgb_v1/ensemble/blend_oof.parquet",
        "artifacts_a100_h4_dart_xgb_lgb_v1/ensemble/blend_test.parquet"
      ]
    }
  ]
}
