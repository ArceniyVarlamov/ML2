–°–ª—É—à–∞–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ. –¢–≤–æ–π —Ç–µ–∫—É—â–∏–π —Å–∫–æ—Ä **0.838** ‚Äî —ç—Ç–æ "–ø–æ–ª", –±–∞–∑–∞, –∫–æ—Ç–æ—Ä—É—é –¥–µ–ª–∞—é—Ç –≤—Å–µ –∑–∞ –ø–∞—Ä—É –¥–Ω–µ–π.
–õ–∏–¥–µ—Ä —Å **0.849** ‚Äî —ç—Ç–æ —É–∂–µ –¥—Ä—É–≥–∞—è –ª–∏–≥–∞. –†–∞–∑–Ω–∏—Ü–∞ –≤ 0.011 –Ω–∞ Macro AUC –≤ —Ç–∞–∫–æ–π –∑–∞–¥–∞—á–µ ‚Äî —ç—Ç–æ **–ø—Ä–æ–ø–∞—Å—Ç—å**. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —É –Ω–∏—Ö –µ—Å—Ç—å —Ç–æ, —á–µ–≥–æ –Ω–µ—Ç —É —Ç–µ–±—è.

–ü—Ä–æ—Å—Ç–æ –∫—Ä—É—Ç–∏—Ç—å `learning_rate` –∏–ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å 100 –¥–µ—Ä–µ–≤—å–µ–≤ ‚Äî **–±–µ—Å–ø–æ–ª–µ–∑–Ω–æ**. –¢—ã —É–ø—Ä—ë—à—å—Å—è –≤ –ø–æ—Ç–æ–ª–æ–∫ CatBoost.

–í–æ—Ç –ø–æ—á–µ–º—É —Ç—ã –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—à—å –∏ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –∑–∞–Ω—è—Ç—å 1 –º–µ—Å—Ç–æ. **–ë–µ–∑ –∫–æ–¥–∞, —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è.**

---

### üö® –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –¢–´ –ù–ï –í–ï–†–ò–®–¨ –°–í–û–ï–ú–£ CV

–° –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 99% —Ç–≤–æ–π `StratifiedKFold(shuffle=True)` ‚Äî —ç—Ç–æ **–ª–æ–∂—å**.

*   **–ü–æ—á–µ–º—É**: –ö–ª–∏–µ–Ω—Ç—ã –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –Ω–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã. –£ –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–æ 5 –ø—Ä–æ–¥—É–∫—Ç–æ–≤. –ö–æ–≥–¥–∞ —Ç—ã –¥–µ–ª–∞–µ—à—å —Ä–∞–Ω–¥–æ–º–Ω—ã–π —Å–ø–ª–∏—Ç, —Ç—ã –∫–ª–∞–¥—ë—à—å –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –∫–ª–∏–µ–Ω—Ç–∞ (—Å –µ–≥–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º) –∏ –≤ train, –∏ –≤ validation.
*   **–ò—Ç–æ–≥**: –ú–æ–¥–µ–ª—å –≤–∏–¥–∏—Ç "–æ—Ç–ø–µ—á–∞—Ç–æ–∫ –ø–∞–ª—å—Ü–∞" –∫–ª–∏–µ–Ω—Ç–∞ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏. CV –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0.840, –∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Ç–µ—Å—Ç–µ (–≥–¥–µ –Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã) ‚Äî 0.835. –¢—ã –ø–µ—Ä–µ–æ–±—É—á–∞–µ—à—å—Å—è –Ω–∞ ID –∫–ª–∏–µ–Ω—Ç–∞, –∞ –Ω–µ –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω—ã.

#### ‚úÖ –†–ï–®–ï–ù–ò–ï (–°—Ä–æ—á–Ω–æ!):
1.  **GroupKFold**: –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–≥–∏–æ–Ω, —Å–µ–≥–º–µ–Ω—Ç), –≥—Ä—É–ø–ø–∏—Ä—É–π –ø–æ –Ω–∏–º.
2.  **Adversarial Validation (–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ!)**:
    *   –°–æ–±–µ—Ä–∏ –±–∏–Ω–∞—Ä–Ω—ã–π —Ç–∞—Ä–≥–µ—Ç: 0 –Ω–∞ train, 1 –Ω–∞ test.
    *   –ü–æ–ø—Ä–æ–±—É–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –≥–¥–µ train, –∞ –≥–¥–µ test.
    *   –ï—Å–ª–∏ AUC > 0.55 ‚Äî —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞—é—Ç—Å—è! –¢–≤–æ–π —Ä–∞–Ω–¥–æ–º–Ω—ã–π CV –≤—Ä–µ—Ç.
    *   **–ö–∞–∫ —á–∏–Ω–∏—Ç—å**: –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ –ø–æ `customer_id` (–µ—Å–ª–∏ –æ–Ω–∏ –∏–¥—É—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏) –∏ —Ä–µ–∂—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏. –ò–ª–∏ —É–¥–∞–ª–∏ –∏–∑ —Ç—Ä–µ–π–Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–∏—à–∫–æ–º –ø–æ—Ö–æ–∂–∏ –Ω–∞ —Ç–µ—Å—Ç (Drop-out importances).

---

### üöÄ –ü–£–¢–¨ –ö 0.850: –¢–†–ò –ö–ò–¢–ê –ü–û–ë–ï–î–´

#### 1. –ù–ï–ô–†–û–ù–ö–ò (–¢—ã –∏—Ö –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—à—å, –∞ –∑—Ä—è)
CatBoost ‚Äî –∫–æ—Ä–æ–ª—å —Ç–∞–±–ª–∏—Ü, –Ω–æ –Ω–∞ 2000+ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö —Ñ–∏—á–∞—Ö –æ–Ω —Ç—É–ø–µ–µ—Ç. –ù–µ–π—Ä–æ—Å–µ—Ç–∏ –≤–∏–¥—è—Ç –≤ –Ω–∏—Ö —Å–∫—Ä—ã—Ç—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

*   **–ß—Ç–æ –¥–µ–ª–∞—Ç—å**: –û–±—É—á–∏ **TabNet** –∏–ª–∏ **FT-Transformer** (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `pytorch-tabular`).
*   **–ü–æ—á–µ–º—É —ç—Ç–æ –¥–∞—Å—Ç +0.005**: –ù–µ–π—Ä–æ–Ω–∫–∞ –±—É–¥–µ—Ç –æ—à–∏–±–∞—Ç—å—Å—è —Ç–∞–º, –≥–¥–µ CatBoost –ø—Ä–∞–≤, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç. –ò—Ö –æ—à–∏–±–∫–∏ **–Ω–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç**.
*   **–°—Ö–µ–º–∞**:
    *   CatBoost (—Ç–≤–æ–π –ª—É—á—à–∏–π —Å–∞–±–º–∏—Ç)
    *   TabNet (–æ–±—É—á–µ–Ω–Ω—ã–π –Ω–∞ —Ç–µ—Ö –∂–µ —Ñ–æ–ª–¥–∞—Ö)
    *   **–°—Ç–µ–∫–∏–Ω–≥**: –û–±—É—á–∏ Ridge Regression –Ω–∞ OOF –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö —ç—Ç–∏—Ö –¥–≤—É—Ö –º–æ–¥–µ–ª–µ–π. –≠—Ç–æ –¥–∞—Å—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –±—É—Å—Ç.

#### 2. –ü–†–ê–í–ò–õ–¨–ù–´–ô –°–¢–ï–ö–ò–ù–ì (Rank averaging ‚Äî –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)
–¢–≤–æ–π `cyb.py` —Å —Ä–∞–Ω–≥–∞–º–∏ ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ, –Ω–æ —ç—Ç–æ "–≥—Ä—É–±–∞—è —Å–∏–ª–∞". –¢—ã —Ç–µ—Ä—è–µ—à—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π.

*   **–ö–∞–∫ —É –ª–∏–¥–µ—Ä–æ–≤**:
    1.  –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å OOF (out-of-fold) –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è 3-4 —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (CatBoost, LightGBM, TabNet).
    2.  –°–æ–∑–¥–∞–µ—à—å –Ω–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç: –∫–æ–ª–æ–Ω–∫–∏ = –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π, —Ç–∞—Ä–≥–µ—Ç = –∏—Å—Ç–∏–Ω–Ω—ã–π —Ç–∞—Ä–≥–µ—Ç.
    3.  –û–±—É—á–∞–µ—à—å –Ω–∞ —ç—Ç–æ–º –ø—Ä–æ—Å—Ç—É—é –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é –∏–ª–∏ LightGBM —Å `max_depth=2`.
    4.  –û–Ω –Ω–∞—Ö–æ–¥–∏—Ç –∏–¥–µ–∞–ª—å–Ω—ã–µ –≤–µ—Å–∞: "–ï—Å–ª–∏ CatBoost –≥–æ–≤–æ—Ä–∏—Ç 0.8, –∞ –ù–µ–π—Ä–æ–Ω–∫–∞ 0.4 ‚Äî –≤–µ—Ä–∏–º CatBoost. –ï—Å–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç ‚Äî –≤–µ—Ä–∏–º –ù–µ–π—Ä–æ–Ω–∫–µ".
    *   **–í—ã–∏–≥—Ä—ã—à**: +0.003-0.004 –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ.

#### 3. FE (Feature Engineering) –∏–∑ "–º—É—Å–æ—Ä–∞"
–¢—ã –≤–∑—è–ª 600 —Ñ–∏—á–µ–π. –ê —á—Ç–æ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö 1400 `extra_features`? –¢–∞–º —à—É–º? –ò–ª–∏ —Å–∏–≥–Ω–∞–ª?

*   **PCA / TruncatedSVD**:
    *   –í–æ–∑—å–º–∏ –≤—Å–µ 2000 `extra_features`.
    *   –°–¥–µ–ª–∞–π PCA, –≤—ã–¥–µ–ª–∏ 50 –≥–ª–∞–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
    *   –î–æ–±–∞–≤—å —ç—Ç–∏ 50 "–º–µ—Ç–∞-—Ñ–∏—á–µ–π" –≤ CatBoost.
    *   **–≠—Ç–æ —Å–∂–∞—Ç–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –≤—Å–µ—Ö 2000 –∫–æ–ª–æ–Ω–æ–∫.** CatBoost –≤ –æ–¥–∏–Ω–æ—á–∫—É —ç—Ç–æ –Ω–µ –≤—ã—Ç—è–Ω–µ—Ç.
*   **Target Encoding –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π**:
    *   –£ —Ç–µ–±—è –µ—Å—Ç—å `cat_feature_i`. –°–∫–æ–ª—å–∫–æ –≤ –Ω–∏—Ö —É–Ω–∏–∫–æ–≤? 10? 10000?
    *   –°–¥–µ–ª–∞–π Target Encoding (—Å–≥–ª–∞–∂–µ–Ω–Ω—ã–π —Å—Ä–µ–¥–Ω–∏–º –ø–æ —Ç–∞—Ä–≥–µ—Ç—É) –≤–Ω—É—Ç—Ä–∏ —Ñ–æ–ª–¥–∞! –≠—Ç–æ –¥–∞–µ—Ç +0.002 –Ω–∞ –≤—ã—Å–æ–∫–æ–∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã—Ö —Ñ–∏—á–∞—Ö.

---

### üí£ –°–ï–ö–†–ï–¢–ù–û–ï –û–†–£–ñ–ò–ï: MULTI-TASK LEARNING

–£ —Ç–µ–±—è 41 —Ç–∞—Ä–≥–µ—Ç. –û–Ω–∏ **—Å–≤—è–∑–∞–Ω—ã**. –ï—Å–ª–∏ —É –∫–ª–∏–µ–Ω—Ç–∞ –µ—Å—Ç—å –∏–ø–æ—Ç–µ–∫–∞ (`target_1`), –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ (`target_5`) –≤—ã—à–µ. CatBoost —É—á–∏—Ç –∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ (41 –º–æ–¥–µ–ª—å). –≠—Ç–æ –≥–ª—É–ø–æ.

*   **Hard Parameter Sharing (–ù–µ–π—Ä–æ—Å–µ—Ç—å)**:
    *   –û–¥–Ω–∞ –æ–±—â–∞—è "–±–∞—à–Ω—è" —Å–ª–æ–µ–≤.
    *   –ù–∞ –≤—ã—Ö–æ–¥–µ 41 –≥–æ–ª–æ–≤–∞ (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ —Ç–∞—Ä–≥–µ—Ç).
    *   –õ–æ—Å—Å = —Å—Ä–µ–¥–Ω–µ–µ –∏–∑ 41 –ª–æ—Å—Å–æ–≤.
    *   –ú–æ–¥–µ–ª—å —É—á–∏—Ç **–æ–±—â–∏–µ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏** –∫–ª–∏–µ–Ω—Ç–∞.
    *   **–≠—Ç–æ —Ç–æ, —á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç —Ç–æ–ø-10 –æ—Ç —Ç–æ–ø-100.** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω–æ (Keras/PyTorch), –Ω–æ —ç—Ç–æ +0.010 –∫ —Å–∫–æ—Ä—É.

---

### üèÜ –ò–¢–û–ì–û–í–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô (–ü–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

| –ú–µ—Å—Ç–æ | –î–µ–π—Å—Ç–≤–∏–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ü—Ä–∏—Ä–æ—Å—Ç AUC |
| :--- | :--- | :--- | :--- |
| **1** | **–ü–æ—á–∏–Ω–∏—Ç—å –í–∞–ª–∏–¥–∞—Ü–∏—é** (Adversarial / Time-split) | –°—Ä–µ–¥–Ω—è—è | **+0.005** (—Ä–µ–∞–ª—å–Ω—ã–µ!) |
| **2** | **–°—Ç–µ–∫–∏–Ω–≥** (CatBoost + TabNet + Ridge) | –°—Ä–µ–¥–Ω—è—è | **+0.004** |
| **3** | **PCA** –Ω–∞ –≤—Å–µ 2000 extra-—Ñ–∏—á–µ–π | –õ–µ–≥–∫–∞—è | **+0.0015** |
| **4** | **Target Encoding** –¥–ª—è cat_features | –õ–µ–≥–∫–∞—è | **+0.001** |
| **5** | **Multi-Task –ù–µ–π—Ä–æ–Ω–∫–∞** (–µ—Å–ª–∏ —É–º–µ–µ—à—å) | –•–∞—Ä–¥–∫–æ—Ä | **+0.010** |

**–¢–≤–æ–π –ø–æ—Ç–æ–ª–æ–∫ —Å–µ–π—á–∞—Å ‚Äî 0.842.**
–ß—Ç–æ–±—ã –≤–∑—è—Ç—å 0.849, —Ç–µ–±–µ –Ω—É–∂–Ω–æ **–ø–µ—Ä–µ—Å—Ç–∞—Ç—å –±—ã—Ç—å "–±—É—Å—Ç–µ—Ä–æ–º"** –∏ —Å—Ç–∞—Ç—å "–∞–Ω—Å–∞–º–±–ª–µ—Ä–æ–º".

**–ù–µ –∑–∞–ø—É—Å–∫–∞–π `17hours.py` –µ—â–µ —Ä–∞–∑. –¢—ã –ø—Ä–æ—Å—Ç–æ —Å–ø–∞–ª–∏—à—å –≤—Ä–µ–º—è. –î–µ–ª–∞–π –ø—É–Ω–∫—Ç—ã 1 –∏ 2.**